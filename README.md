# Прогнозирование оттока клиентов для «Телеком-Плюс»

## Описание проекта

Этот проект посвящен разработке системы прогнозирования оттока клиентов для телекоммуникационной компании «Телеком-Плюс». Основная цель — выявить клиентов, склонных к оттоку, чтобы компания могла предпринять упреждающие меры по их удержанию. Проект демонстрирует сквозной пайплайн машинного обучения, начиная от разведочного анализа данных (EDA) и заканчивая построением модели глубокого обучения и ее интерпретацией.

## Особенности проекта

*   **Сквозной пайплайн:** Весь процесс (EDA, feature engineering, борьба с дисбалансом, моделирование) реализован в виде воспроизводимого кода, инкапсулированного в функции и модули.
*   **Автоматизированная предобработка:** Использование `sklearn.pipeline.Pipeline` и `ColumnTransformer` для эффективной и гибкой предобработки данных.
*   **Глубокое обучение:** Разработка и обучение многослойного перцептрона (MLP) с использованием TensorFlow/Keras, с экспериментами по архитектуре, регуляризации (Dropout, Batch Normalization) и коллбэками (EarlyStopping).
*   **Интерпретируемость модели:** Применение методов SHAP для объяснения предсказаний модели на индивидуальном и глобальном уровнях.
*   **Анализ ошибок:** Детальный анализ случаев, когда модель ошибается, для выявления паттернов и потенциальных улучшений.
*   **Бизнес-рекомендации:** Формирование конкретных рекомендаций для бизнеса на основе полученных инсайтов.

## Набор данных

В проекте используется набор данных `churn-bigml-80.csv`, содержащий исторические данные о клиентах, их тарифах, услугах и фактах оттока. Набор данных характеризуется:
*   **Дисбалансом классов:** Значительное преобладание клиентов, не ушедших из компании.
*   **Разнородностью признаков:** Числовые и категориальные данные.
*   **Отсутствием явных пропусков:** Однако, могут присутствовать неявные значения, требующие обработки.

## Структура проекта

*   `data_preprocessing.py`: Модуль, содержащий функции для загрузки данных, их предобработки (масштабирование, кодирование, балансировка классов с помощью SMOTE) и создания пайплайна предобработки.
*   `train_model.py`: Модуль с функциями для построения, компиляции, обучения, оценки и сохранения модели глубокого обучения (MLP).
*   `EDA_and_Prediction.ipynb`: Основной Jupyter Notebook, который оркестрирует весь рабочий процесс: загрузка данных, EDA, вызов функций предобработки и обучения модели, оценка, интерпретация с SHAP и анализ ошибок.
*   `utils.py`: (В настоящее время пуст) Модуль для вспомогательных функций, которые могут быть использованы в разных частях проекта.
*   `actions.txt`: Файл с описанием выполненных действий.
*   `presentation.txt`: Текстовый файл с содержанием для презентации.

## Установка и запуск

### 1. Клонирование репозитория (если применимо)

```bash
# git clone <URL_вашего_репозитория>
# cd <название_папки_проекта>
```

### 2. Установка зависимостей

Убедитесь, что у вас установлен Python (рекомендуется 3.8+). Установите необходимые библиотеки:

```bash
pip install pandas numpy scikit-learn imbalanced-learn tensorflow shap matplotlib seaborn
```

### 3. Подготовка данных

Поместите файл `churn-bigml-80.csv` в корневую директорию проекта (ту же директорию, где находится `EDA_and_Prediction.ipynb`).

### 4. Запуск проекта

Откройте и запустите Jupyter Notebook `EDA_and_Prediction.ipynb`.

```bash
jupyter notebook EDA_and_Prediction.ipynb
```

Последовательно выполните все ячейки ноутбука. Ноутбук проведет вас через следующие этапы:
*   Загрузка и первичный анализ данных.
*   Детальный EDA с визуализациями.
*   Предобработка данных и балансировка классов.
*   Построение, обучение и оценка модели MLP.
*   Интерпретация модели с помощью SHAP.
*   Анализ ошибок и формирование бизнес-рекомендаций.

## Результаты и рекомендации

Ноутбук `EDA_and_Prediction.ipynb` содержит подробные результаты анализа, метрики производительности модели, визуализации SHAP для глобальной и локальной интерпретации, а также конкретные бизнес-рекомендации, основанные на полученных инсайтах. Эти рекомендации направлены на снижение оттока клиентов путем таргетированных предложений и улучшения качества обслуживания.
